<!DOCTYPE html>
<html lang="zh-TW" data-theme="black">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExoWorld | æ¢ç´¢å¾®ç¸®ç”Ÿæ…‹</title>
    
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.7.2/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                        serif: ['"Playfair Display"', 'serif'],
                    },
                    colors: {
                        aqua: '#2dd4bf',    /* æ°´æ—ä»£è¡¨è‰² Teal-400 */
                        terra: '#fb923c',   /* å…©æ£²ä»£è¡¨è‰² Orange-400 */
                        darkbg: '#0a0a0a',
                        cardbg: '#1a1a1a',
                    },
                    animation: {
                        'slide-in-right': 'slideInRight 0.5s ease-out forwards',
                        'bounce-subtle': 'bounceSubtle 2s infinite',
                    },
                    keyframes: {
                        slideInRight: {
                            '0%': { transform: 'translateX(100%)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        },
                        bounceSubtle: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            background-image: radial-gradient(circle at 50% 0%, #1a2e35 0%, #050505 60%);
            min-height: 100vh;
        }
        
        .text-glow {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .glass-nav {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* ç‰©ç¨®æŒ‰éˆ•ç‰¹æ•ˆ */
        .species-btn {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ›è¡Œ */
        }
        .species-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0%;
            height: 2px;
            background-color: currentColor;
            transition: width 0.3s ease;
        }
        .species-btn.active::after {
            width: 100%;
        }
        
        /* å½±ç‰‡å®¹å™¨ RWD */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 ratio */
            height: 0;
            overflow: hidden;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            background: #000;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .category-card:hover img {
            transform: scale(1.05);
        }

        /* è‡ªå®šç¾©æ²è»¸ */
        .scrolling-wrapper {
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }
        .scrolling-wrapper::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        /* é¡åˆ¥å¡ç‰‡ç‰¹æ•ˆ */
        .category-card-hover {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .category-card-hover:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }
        .category-card-hover:hover .category-bg {
            transform: scale(1.1);
            filter: brightness(0.8);
        }

        /* æœå°‹çµæœä¸‹æ‹‰é¸å–®å‹•ç•« */
        #search-results {
            scrollbar-width: thin;
            scrollbar-color: #333 #111;
        }
        #search-results::-webkit-scrollbar {
            width: 8px;
        }
        #search-results::-webkit-scrollbar-track {
            background: #111;
        }
        #search-results::-webkit-scrollbar-thumb {
            background-color: #333;
            border-radius: 20px;
        }

        /* --- æ–°å¢ï¼šæ·±æµ·æ°£æ³¡å‹•ç•«ç‰¹æ•ˆ --- */
        .bubbles-container {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            top: 0;
            left: 0;
            pointer-events: none; /* è®“é»æ“Šå¯ä»¥ç©¿é€ */
            z-index: 1; /* åœ¨èƒŒæ™¯åœ–ä¹‹ä¸Šï¼Œæ–‡å­—ä¹‹ä¸‹ */
        }
        
        .bubble {
            position: absolute;
            bottom: -100px;
            background-color: rgba(255, 255, 255, 0.15); /* åŠé€æ˜ç™½ */
            border-radius: 50%;
            opacity: 0;
            animation: rise 15s infinite ease-in;
            box-shadow: 0 0 10px rgba(255,255,255,0.1);
        }

        .bubble:nth-child(odd) {
            background-color: rgba(45, 212, 191, 0.1); /* å¶çˆ¾å‡ºç¾ä¸€é» Aqua è‰²æ°£æ³¡ */
        }

        @keyframes rise {
            0% {
                bottom: -100px;
                transform: translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            50% {
                transform: translateX(30px);
            }
            100% {
                bottom: 120%; /* é£„å‡ºè¢å¹•ä¸Šæ–¹ */
                transform: translateX(-30px);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="text-gray-300 font-sans antialiased selection:bg-aqua selection:text-black">

    <div class="navbar fixed top-0 z-50 glass-nav h-20">
        <div class="container mx-auto px-4">
            <div class="flex-1">
                <a class="btn btn-ghost text-2xl font-serif tracking-widest text-white hover:bg-transparent" href="#" onclick="location.reload()">
                    EXO<span class="text-aqua">WORLD</span>
                </a>
            </div>
            
            <div class="flex-none hidden md:block">
                <ul class="menu menu-horizontal px-1 font-medium tracking-wide">
                    <li><a class="hover:text-aqua transition-colors cursor-pointer" onclick="resetToCategories(); document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'})">é¦–é </a></li>
                    <li><a class="hover:text-aqua transition-colors cursor-pointer" onclick="selectCategory('aquarium'); document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'})">æ°´æ—åœ–é‘‘</a></li>
                    <li><a class="hover:text-terra transition-colors cursor-pointer" onclick="selectCategory('amphibian'); document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'})">å…©æ£²åœ–é‘‘</a></li>
                    <li><a class="hover:text-white transition-colors cursor-pointer" onclick="showLandscapingView(); document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'})">é€ æ™¯ç¾å­¸</a></li>
                </ul>
            </div>

            <div class="flex-none ml-2">
                <div class="tooltip tooltip-bottom" data-tip="ç‰¹å¯µé†«ç™‚åœ°åœ–">
                    <button class="btn btn-ghost btn-circle text-red-400 hover:bg-red-500/20 hover:text-red-400" onclick="document.getElementById('vet_modal').showModal()">
                        <i class="fa-solid fa-suitcase-medical text-xl"></i>
                    </button>
                </div>
            </div>

            <div class="flex-none ml-2">
                <div class="dropdown dropdown-end" id="notification-dropdown">
                    <div role="button" class="btn btn-ghost btn-circle group" onclick="toggleNotification(event)">
                        <div class="indicator">
                            <i class="fa-solid fa-bell text-xl text-gray-300 group-hover:text-white transition-colors"></i>
                            <span class="badge badge-xs badge-error indicator-item animate-pulse"></span>
                        </div>
                    </div>
                    
                    <div class="mt-3 z-[1] card card-compact dropdown-content w-80 bg-[#1a1a1a]/95 backdrop-blur-xl border border-gray-700 shadow-2xl">
                        <div class="card-body">
                            <h3 class="font-bold text-lg text-white flex items-center gap-2 border-b border-gray-700 pb-2">
                                <i class="fa-solid fa-bullhorn text-aqua"></i> æœ€æ–°å±•è¦½è³‡è¨Š
                            </h3>
                            <ul class="flex flex-col gap-3 mt-2 max-h-60 overflow-y-auto" id="notification-list">
                                </ul>
                            </div>
                    </div>
                </div>
            </div>

            <div class="flex-none md:hidden ml-2">
                <button class="btn btn-square btn-ghost text-white">
                    <i class="fa-solid fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="hero min-h-screen relative overflow-hidden flex flex-col justify-center">
        
        <div class="absolute inset-0 z-0">
            <img src="https://images.unsplash.com/photo-1546284687-353279c61453?q=80&w=2000&auto=format&fit=crop" 
                 class="w-full h-full object-cover opacity-60" 
                 alt="Aquarium background">
            <div class="absolute inset-0 bg-gradient-to-b from-black/50 via-[#0a192f]/60 to-[#050505]"></div>
        </div>

        <div class="bubbles-container">
            <div class="bubble" style="width: 40px; height: 40px; left: 10%; animation-duration: 8s; animation-delay: 0s;"></div>
            <div class="bubble" style="width: 20px; height: 20px; left: 20%; animation-duration: 12s; animation-delay: 2s;"></div>
            <div class="bubble" style="width: 50px; height: 50px; left: 35%; animation-duration: 15s; animation-delay: 4s;"></div>
            <div class="bubble" style="width: 80px; height: 80px; left: 50%; animation-duration: 18s; animation-delay: 1s;"></div>
            <div class="bubble" style="width: 35px; height: 35px; left: 55%; animation-duration: 10s; animation-delay: 5s;"></div>
            <div class="bubble" style="width: 25px; height: 25px; left: 65%; animation-duration: 14s; animation-delay: 3s;"></div>
            <div class="bubble" style="width: 60px; height: 60px; left: 75%; animation-duration: 20s; animation-delay: 6s;"></div>
        </div>

        <div class="hero-content text-center text-neutral-content z-10 relative mt-16 w-full max-w-4xl px-4">
            <div class="max-w-3xl mx-auto">
                <div class="inline-block px-4 py-1 border border-white/20 rounded-full text-sm text-gray-300 mb-6 backdrop-blur-md animate-bounce-subtle cursor-pointer hover:bg-white/10 transition-colors" onclick="toggleNewsToast()">
                    ğŸ”” é»æ“ŠæŸ¥çœ‹è¿‘æœŸç†±é–€å±•è¦½èˆ‡æ–‡ç« 
                </div>
                <h1 class="mb-5 text-5xl md:text-7xl font-bold text-white font-serif tracking-tight text-glow">
                    æ¢ç´¢å¾®ç¸®ç”Ÿæ…‹
                </h1>
                <p class="mb-8 text-lg md:text-xl text-gray-300 font-light leading-relaxed">
                    åœ¨ç»ç’ƒç‰†å…§ï¼Œæ§‹å»ºä¸€å€‹å®Œç¾çš„ç•°ä¸–ç•Œã€‚<br>
                    æ‚¨å¯ä»¥æœå°‹ã€Œæ–°æ‰‹ã€ã€ã€Œç´…è‰²ã€æˆ–ã€Œå…æ‰“æ°£ã€ä¾†å°‹æ‰¾é©åˆçš„å¤¥ä¼´ã€‚
                </p>
                
                <div class="relative max-w-2xl mx-auto mb-6 group z-50">
                    <div class="flex items-center bg-white/10 backdrop-blur-md rounded-full border border-white/20 p-2 shadow-2xl focus-within:bg-black/80 focus-within:border-aqua transition-all duration-300">
                        
                        <div class="dropdown dropdown-hover">
                            <div tabindex="0" role="button" class="btn btn-ghost btn-circle btn-sm text-gray-400 hover:text-white" id="search-filter-btn">
                                <i class="fa-solid fa-filter"></i>
                            </div>
                            <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-gray-900 rounded-box w-32 border border-gray-700 mt-2">
                                <li><a onclick="setSearchFilter('all')">å…¨éƒ¨</a></li>
                                <li><a onclick="setSearchFilter('aquarium')" class="text-aqua">æ°´æ—</a></li>
                                <li><a onclick="setSearchFilter('amphibian')" class="text-terra">å…©æ£²</a></li>
                            </ul>
                        </div>

                        <input type="text" 
                               id="search-input"
                               placeholder="æœå°‹ç‰©ç¨®åç¨± (ex: å®ˆå®®)..." 
                               class="bg-transparent border-none text-white w-full px-4 focus:ring-0 placeholder-gray-500"
                               autocomplete="off">
                        
                        <button class="btn btn-circle btn-ghost text-aqua hover:bg-aqua/20">
                            <i class="fa-solid fa-search text-lg"></i>
                        </button>
                    </div>

                    <div id="search-results" class="absolute left-0 right-0 top-full mt-2 bg-gray-900/95 backdrop-blur-xl border border-gray-700 rounded-2xl shadow-2xl overflow-y-auto max-h-80 hidden">
                    </div>
                    
                    <div id="filter-tag" class="absolute -bottom-8 left-4 text-xs text-gray-500 opacity-0 transition-opacity">
                        æœå°‹ç¯„åœ: å…¨éƒ¨
                    </div>
                </div>

                <div class="flex justify-center gap-4 mb-10">
                    <button onclick="document.getElementById('recommendation_modal').showModal()" 
                            class="btn btn-sm md:btn-md btn-ghost text-gray-300 hover:text-white border border-white/10 hover:border-aqua/50 hover:bg-aqua/10 rounded-full gap-2 transition-all">
                        <i class="fa-solid fa-wand-magic-sparkles text-yellow-400"></i>
                        ä¸çŸ¥é“é¤Šä»€éº¼ï¼Ÿæ¸¬æ¸¬ä½ çš„å‘½å®šå¯µç‰©
                    </button>
                </div>

                <div class="flex gap-4 justify-center">
                    <button onclick="document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'}); resetToCategories();" 
                            class="btn btn-outline border-aqua text-aqua hover:bg-aqua hover:text-black hover:border-aqua px-8 rounded-full transition-all duration-300 shadow-[0_0_20px_rgba(45,212,191,0.2)]">
                        ç€è¦½å…¨éƒ¨åˆ†é¡
                    </button>
                </div>
            </div>
        </div>
        
        <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce text-gray-500">
            <i class="fa-solid fa-chevron-down"></i>
        </div>
    </div>

    <div id="toast-container" class="fixed bottom-5 right-5 z-50 transform translate-x-full transition-transform duration-500 ease-out">
        </div>

    <dialog id="vet_modal" class="modal modal-bottom sm:modal-middle">
        <div class="modal-box bg-[#1a1a1a] border border-gray-700 w-11/12 max-w-3xl">
            <form method="dialog">
                <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">âœ•</button>
            </form>
            
            <div class="text-center mb-6">
                <h3 class="font-bold text-2xl text-white mb-2">
                    <i class="fa-solid fa-user-doctor text-red-400 mr-2"></i>å…¨å°ç‰¹å¯µ/æ°´æ—é†«ç™‚è³‡æºç¶²
                </h3>
                <p class="text-gray-400 text-sm">
                    æ³¨æ„ï¼šç‰¹æ®Šå¯µç‰©é†«ç™‚è³‡æºç¨€ç¼ºï¼Œå»ºè­°å°±è¨ºå‰å…ˆè‡´é›»ç¢ºèªé†«å¸«ç­è¡¨ã€‚<br>
                    <span class="text-red-400 text-xs">*æœ¬è³‡æ–™åƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›çœ‹è¨ºé …ç›®ä»¥é™¢æ–¹å…¬å‘Šç‚ºæº–ã€‚</span>
                </p>
            </div>

            <div class="flex flex-wrap gap-2 justify-center mb-6">
                <select id="vet-region" class="select select-bordered select-sm bg-gray-800 text-white" onchange="filterVets()">
                    <option value="all">å…¨å°ç£</option>
                    <option value="north">åŒ—éƒ¨åœ°å€</option>
                    <option value="central">ä¸­éƒ¨åœ°å€</option>
                    <option value="south">å—éƒ¨åœ°å€</option>
                </select>
                <select id="vet-type" class="select select-bordered select-sm bg-gray-800 text-white" onchange="filterVets()">
                    <option value="all">æ‰€æœ‰ç§‘åˆ¥</option>
                    <option value="reptile">çˆ¬èŸ²/å…©æ£²å°ˆç§‘</option>
                    <option value="aquatic">é­šé¡/æ°´æ—å°ˆç§‘</option>
                </select>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto pr-2" id="vet-list">
                </div>
        </div>
        <form method="dialog" class="modal-backdrop">
            <button>close</button>
        </form>
    </dialog>

    <dialog id="recommendation_modal" class="modal modal-bottom sm:modal-middle">
        <div class="modal-box bg-[#1a1a1a] border border-gray-700">
            <form method="dialog">
                <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">âœ•</button>
            </form>
            <h3 class="font-bold text-2xl text-white mb-2 text-center">
                <i class="fa-solid fa-user-astronaut text-aqua mr-2"></i>ä½ çš„é£¼é¤Šé¢¨æ ¼æ˜¯ï¼Ÿ
            </h3>
            <p class="py-4 text-center text-gray-400">é»æ“Šæœ€ç¬¦åˆä½ çš„æè¿°ï¼Œæˆ‘å€‘å°‡ç‚ºä½ æ¨è–¦é©åˆçš„å¤¥ä¼´ï¼</p>
            
            <div class="grid grid-cols-2 gap-4 mt-2">
                <button onclick="performRecommendation('lazy')" class="btn h-auto py-4 bg-gray-800 border-gray-700 hover:border-aqua hover:bg-gray-700 flex flex-col gap-2 group">
                    <i class="fa-solid fa-couch text-2xl text-gray-500 group-hover:text-aqua transition-colors"></i>
                    <span class="text-white">æˆ‘æ˜¯æ‡¶äºº / å¾ˆå¿™</span>
                    <span class="text-xs text-gray-500 font-normal">ä¸€é€±é¤µä¸€æ¬¡å°±å¥½</span>
                </button>
                
                <button onclick="performRecommendation('interactive')" class="btn h-auto py-4 bg-gray-800 border-gray-700 hover:border-terra hover:bg-gray-700 flex flex-col gap-2 group">
                    <i class="fa-solid fa-hand-holding-heart text-2xl text-gray-500 group-hover:text-terra transition-colors"></i>
                    <span class="text-white">æˆ‘å–œæ­¡äº’å‹•</span>
                    <span class="text-xs text-gray-500 font-normal">æƒ³è¦å¯ä»¥ä¸Šæ‰‹çš„</span>
                </button>

                <button onclick="performRecommendation('office')" class="btn h-auto py-4 bg-gray-800 border-gray-700 hover:border-blue-400 hover:bg-gray-700 flex flex-col gap-2 group">
                    <i class="fa-solid fa-building text-2xl text-gray-500 group-hover:text-blue-400 transition-colors"></i>
                    <span class="text-white">è¾¦å…¬å®¤ç™‚ç™’</span>
                    <span class="text-xs text-gray-500 font-normal">å®‰éœã€é«”ç©å°</span>
                </button>

                <button onclick="performRecommendation('cool')" class="btn h-auto py-4 bg-gray-800 border-gray-700 hover:border-purple-400 hover:bg-gray-700 flex flex-col gap-2 group">
                    <i class="fa-solid fa-dragon text-2xl text-gray-500 group-hover:text-purple-400 transition-colors"></i>
                    <span class="text-white">å¸¥æ°£ / ç‰¹åˆ¥</span>
                    <span class="text-xs text-gray-500 font-normal">æƒ³é¤Šé»ä¸ä¸€æ¨£çš„</span>
                </button>
            </div>
        </div>
        <form method="dialog" class="modal-backdrop">
            <button>close</button>
        </form>
    </dialog>

    <div class="bg-gradient-to-b from-[#050505] to-[#111] py-24 min-h-screen" id="main-interface">
        <div class="container mx-auto px-4 max-w-6xl">
            
            <div class="text-center mb-16 animate-fade-in-up">
                <h2 class="text-3xl md:text-4xl font-serif text-white mb-6">é—œæ–¼ ExoWorld</h2>
                <div class="max-w-3xl mx-auto">
                    <p class="text-gray-400 text-lg leading-relaxed">
                        æ­¡è¿ä¾†åˆ° ExoWorld å¾®ç¸®ç”Ÿæ…‹åœ–é‘‘ã€‚é€™æ˜¯ä¸€å€‹å°ˆç‚ºåˆå­¸è€…èˆ‡æ„›å¥½è€…æ‰“é€ çš„çŸ¥è­˜å¹³å°ï¼Œ
                        æˆ‘å€‘æ•´ç†äº†å¸‚é¢ä¸Šæœ€å—æ­¡è¿çš„ç‰©ç¨®ï¼Œæä¾›ä¸€ç›®ç­ç„¶çš„é£¼é¤Šæ•¸æ“šèˆ‡æ•™å­¸å½±ç‰‡ã€‚
                        è«‹å¾ä¸‹æ–¹é¸æ“‡æ‚¨æ„Ÿèˆˆè¶£çš„ç”Ÿæ…‹é ˜åŸŸï¼Œé–‹å§‹æ‚¨çš„æ¢ç´¢ä¹‹æ—…ã€‚
                    </p>
                </div>
            </div>

            <div id="category-view" class="transition-all duration-500 opacity-100 transform translate-y-0">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
                    
                    <div class="category-card-hover group relative h-96 rounded-2xl overflow-hidden cursor-pointer border border-gray-800" onclick="selectCategory('aquarium')">
                        <img src="https://images.unsplash.com/photo-1599488615731-7e5c2823ff28?q=80&w=1000&auto=format&fit=crop" 
                             class="category-bg absolute inset-0 w-full h-full object-cover transition-transform duration-700" 
                             alt="Aquarium">
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent opacity-80 group-hover:opacity-60 transition-opacity"></div>
                        <div class="absolute bottom-0 left-0 p-8">
                            <div class="text-aqua mb-2 font-bold tracking-widest text-sm uppercase">Aquarium</div>
                            <h3 class="text-4xl font-serif text-white font-bold mb-4">æ°´æ—ä¸–ç•Œ</h3>
                            <div class="mt-6 flex items-center text-aqua font-bold group-hover:translate-x-2 transition-transform">
                                é€²å…¥åœ–é‘‘ <i class="fa-solid fa-arrow-right ml-2"></i>
                            </div>
                        </div>
                    </div>

                    <div class="category-card-hover group relative h-96 rounded-2xl overflow-hidden cursor-pointer border border-gray-800" onclick="selectCategory('amphibian')">
                        <img src="https://images.unsplash.com/photo-1656927483465-c697bd2fea7e?fm=jpg&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&ixlib=rb-4.1.0&q=60&w=3000" 
                             class="category-bg absolute inset-0 w-full h-full object-cover transition-transform duration-700" 
                             alt="Amphibian">
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent opacity-80 group-hover:opacity-60 transition-opacity"></div>
                        <div class="absolute bottom-0 left-0 p-8">
                            <div class="text-terra mb-2 font-bold tracking-widest text-sm uppercase">Amphibians & Reptiles</div>
                            <h3 class="text-4xl font-serif text-white font-bold mb-4">å…©æ£²çˆ¬èŸ²</h3>
                            <div class="mt-6 flex items-center text-terra font-bold group-hover:translate-x-2 transition-transform">
                                é€²å…¥åœ–é‘‘ <i class="fa-solid fa-arrow-right ml-2"></i>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div id="landscaping-view" class="hidden opacity-0 transition-all duration-500 transform translate-y-10">
                <div class="text-center mb-12 relative">
                    <h2 class="text-4xl font-serif text-white font-bold tracking-wide">Nature in a Box</h2>
                    <p class="text-gray-400 mt-4 max-w-2xl mx-auto">
                        é€ æ™¯ä¸åƒ…æ˜¯ç‚ºäº†ç¾è§€ï¼Œæ›´æ˜¯ç‚ºäº†æ¨¡æ“¬ç”Ÿç‰©çš„åŸç”Ÿç’°å¢ƒã€‚
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="landscaping-grid">
                    </div>
                <dialog id="style_modal" class="modal">
                    <div class="modal-box w-11/12 max-w-4xl bg-[#1a1a1a] p-0 overflow-hidden border border-gray-700 flex flex-col md:flex-row">
                        <div class="w-full md:w-1/2 h-64 md:h-auto">
                            <img id="style-modal-img" src="" class="w-full h-full object-cover">
                        </div>
                        <div class="w-full md:w-1/2 p-8 flex flex-col">
                            <h3 id="style-modal-title" class="text-3xl font-serif font-bold text-white mb-2"></h3>
                            <div class="flex gap-2 mb-4" id="style-modal-tags"></div>
                            <p id="style-modal-desc" class="text-gray-300 leading-relaxed mb-6 flex-grow"></p>
                            <div class="bg-black/30 p-4 rounded-xl border border-white/5">
                                <h4 class="text-sm font-bold text-gray-400 mb-2 uppercase tracking-wider">é—œéµå…ƒç´  (Key Elements)</h4>
                                <ul id="style-modal-elements" class="text-sm text-gray-300 grid grid-cols-2 gap-2"></ul>
                            </div>
                            <div class="modal-action">
                                <form method="dialog">
                                    <button class="btn btn-ghost text-gray-400 hover:text-white">é—œé–‰</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <form method="dialog" class="modal-backdrop">
                        <button>close</button>
                    </form>
                </dialog>
            </div>

            <div id="species-view" class="hidden opacity-0 transition-all duration-500 transform translate-y-10">
                <div class="mb-8 flex items-center">
                    <button onclick="resetToCategories()" class="btn btn-ghost gap-2 text-gray-400 hover:text-white group">
                        <i class="fa-solid fa-arrow-left group-hover:-translate-x-1 transition-transform"></i>
                        è¿”å›åˆ†é¡é¸æ“‡
                    </button>
                    <div class="ml-auto text-sm text-gray-500" id="current-category-label">
                        ç›®å‰ç€è¦½ï¼šæ°´æ—
                    </div>
                </div>

                <div class="relative max-w-4xl mx-auto mb-16">
                    <div class="absolute left-0 top-0 bottom-0 w-8 bg-gradient-to-r from-[#050505] to-transparent z-10 pointer-events-none md:hidden"></div>
                    <div class="absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-[#050505] to-transparent z-10 pointer-events-none md:hidden"></div>
                    <div id="species-buttons-container" class="scrolling-wrapper flex overflow-x-auto gap-3 pb-4 px-4 md:justify-center md:flex-wrap snap-x">
                        </div>
                </div>

                <div class="flex flex-col gap-10 transition-all duration-500" id="species-content">
                    <div class="w-full">
                        <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
                            <div>
                                <div class="badge badge-outline mb-2" id="species-type-badge">åˆ†é¡</div>
                                <h2 class="text-4xl md:text-5xl font-serif text-white font-bold tracking-wide mb-1">
                                    <span id="species-name">è¼‰å…¥ä¸­...</span> 
                                </h2>
                                <span class="text-xl text-gray-500 italic font-serif" id="species-sci-name">å­¸å</span>
                            </div>
                            <div class="text-right hidden md:block">
                                <span class="text-xs text-gray-500 block mb-1">è³‡æ–™ä¾†æº (Data Source)</span>
                                <span class="badge badge-outline text-gray-400" id="data-source">è¼‰å…¥ä¸­...</span>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-2 leading-relaxed text-lg border-l-4 border-gray-700 pl-6" id="species-desc">
                            æè¿°è¼‰å…¥ä¸­...
                        </p>
                    </div>

                    <div class="flex flex-col xl:flex-row items-stretch gap-12">
                        <div class="xl:w-5/12 w-full">
                            <div class="card bg-cardbg shadow-2xl border border-gray-800 overflow-hidden relative group h-full">
                                <figure class="relative h-64 md:h-72 overflow-hidden flex-shrink-0">
                                    <img src="" alt="Species Image" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" id="species-image" referrerpolicy="no-referrer">
                                    <div class="absolute top-4 right-4 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-full border border-white/10 flex items-center gap-2">
                                        <span class="text-xs text-gray-300">é£¼é¤Šé›£åº¦</span>
                                        <div class="text-yellow-400 text-sm" id="difficulty-stars"></div>
                                    </div>
                                </figure>
                                <div class="card-body p-6">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                                            <div class="flex items-center gap-3 mb-2">
                                                <div class="w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400">
                                                    <i class="fa-solid fa-temperature-half"></i>
                                                </div>
                                                <span class="text-sm text-gray-400">é©åˆæº«åº¦</span>
                                            </div>
                                            <div class="text-2xl font-bold text-white pl-1" id="stat-temp">--Â°C</div>
                                        </div>
                                        <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                                            <div class="flex items-center gap-3 mb-2">
                                                <div class="w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400">
                                                    <i class="fa-solid fa-droplet"></i>
                                                </div>
                                                <span class="text-sm text-gray-400" id="stat-env-label">æ°´è³ª/æ¿•åº¦</span>
                                            </div>
                                            <div class="text-xl font-bold text-white pl-1" id="stat-env-val">--</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="xl:w-7/12 w-full flex flex-col">
                            <div class="bg-cardbg rounded-2xl border border-gray-800 p-6 h-full flex flex-col justify-center">
                                <div class="flex justify-between items-end mb-4">
                                    <h3 class="text-white font-bold flex items-center gap-2">
                                        <i class="fa-brands fa-youtube text-red-500"></i> ç²¾é¸é£¼é¤Šæ•™å­¸å½±ç‰‡
                                    </h3>
                                    <a id="video-fallback-link" href="#" target="_blank" class="text-xs text-gray-500 hover:text-white transition-colors flex items-center gap-1">
                                        <i class="fa-solid fa-arrow-up-right-from-square"></i> åœ¨ YouTube ä¸Šè§€çœ‹
                                    </a>
                                </div>
                                <div class="video-container bg-black border border-gray-800 w-full relative">
                                    <iframe id="species-video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                                </div>
                                
                                <div id="video-switcher" class="flex gap-2 mt-3 overflow-x-auto pb-1 hidden">
                                </div>

                                <div class="mt-3 flex items-center justify-between text-xs border-t border-gray-800 pt-3">
                                    <div class="text-gray-500 flex items-center">
                                        <i class="fa-solid fa-video mr-2 text-gray-600"></i>
                                        å½±ç‰‡æˆæ¬Š/ä¾†æºé »é“ï¼š
                                        <span id="video-source-label" class="text-gray-300 font-medium ml-1">è¼‰å…¥ä¸­...</span>
                                    </div>
                                    <div class="md:hidden text-gray-600">
                                        Data Source: <span id="data-source-mobile"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer p-10 bg-black text-neutral-content border-t border-gray-900 mt-20">
        <aside>
            <div class="text-3xl font-serif text-white mb-2">EXO<span class="text-aqua">WORLD</span></div>
            <p>Exploring the Micro-Ecosystems.<br>Designed for Aquarium & Terrarium Hobbyists.</p>
            
            <div id="connection-status" class="badge badge-outline gap-2 mt-4 text-gray-500 border-gray-700">
                <div class="w-2 h-2 rounded-full bg-gray-500"></div>
                Initializing Data...
            </div>
        </aside> 
        <nav>
            <header class="footer-title text-gray-500">åˆ†é¡</header> 
            <a class="link link-hover cursor-pointer" onclick="selectCategory('aquarium'); document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'})">æ°´æ—åœ–é‘‘</a>
            <a class="link link-hover cursor-pointer" onclick="selectCategory('amphibian'); document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'})">å…©æ£²åœ–é‘‘</a>
            <a class="link link-hover cursor-pointer" onclick="showLandscapingView(); document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'})">é€ æ™¯ç¾å­¸</a>
        </nav> 
        <nav>
            <header class="footer-title text-gray-500">è¯çµ¡æˆ‘å€‘</header> 
            <div class="grid grid-flow-col gap-4">
                <a class="text-2xl hover:text-aqua cursor-pointer"><i class="fa-brands fa-instagram"></i></a>
                <a class="text-2xl hover:text-aqua cursor-pointer"><i class="fa-brands fa-facebook"></i></a>
            </div>
        </nav>
    </footer>

    <script>
        // æœ€æ–°æ¶ˆæ¯è³‡æ–™åº« (æ”¹ç‚º letï¼Œä»¥ä¾¿ Google Sheet è¦†è“‹)
        let newsData = [
            {
                title: "2025 å°ä¸­å†¬å­£å¯µç‰©ç”¨å“åšè¦½æœƒ",
                date: "12/25 - 12/28",
                location: "è‡ºä¸­åœ‹éš›å±•è¦½é¤¨",
                type: "expo", 
                url: "https://tcpet-fair.top-link.com.tw/home"
            },
            {
                title: "å°ç£çˆ¬èŸ²ç¥­ (Taiwan Reptile Festival)",
                date: "ç¾æ­£ç†±è³£ä¸­",
                location: "è©³è¦‹å®˜æ–¹é€£çµ",
                type: "reptile",
                url: "https://www.facebook.com/share/r/17mQYw4py9/"
            }
        ];

        // æ¸²æŸ“é€šçŸ¥åˆ—è¡¨
        function renderNotifications() {
            const list = document.getElementById('notification-list');
            if(!list) return;
            
            list.innerHTML = ''; // æ¸…ç©ºåˆ—è¡¨ä»¥é¿å…é‡è¤‡æ¸²æŸ“
            
            // å¦‚æœæ²’æœ‰æ–°èè³‡æ–™ï¼Œé¡¯ç¤ºç©ºç‹€æ…‹ (å¯é¸)
            if (newsData.length === 0) {
                 list.innerHTML = '<li class="text-center text-gray-500 text-xs py-4">ç›®å‰æ²’æœ‰æœ€æ–°æ¶ˆæ¯</li>';
                 return;
            }

            // æ›´æ–° Toast (å–ç¬¬ä¸€å‰‡æœ€æ–°æ¶ˆæ¯)
            const latest = newsData[0];
            const toastContainer = document.getElementById('toast-container');
            if (toastContainer && latest) {
                toastContainer.innerHTML = `
                <div class="bg-[#1a1a1a]/95 backdrop-blur-md border-l-4 border-terra text-white p-4 rounded-lg shadow-2xl max-w-xs md:max-w-sm flex items-start gap-3 relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-1 cursor-pointer text-gray-500 hover:text-white" onclick="hideToast()">
                        <i class="fa-solid fa-times"></i>
                    </div>
                    <div class="text-terra text-xl mt-1">
                        <i class="fa-solid fa-calendar-check"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-sm text-gray-200">æœ€æ–°å¿«è¨Š</h4>
                        <p class="text-sm font-medium mt-1">
                            <span class="text-terra">${latest.date}</span><br>
                            ${latest.title}<br>
                            <span class="text-xs text-gray-400 mt-1 block">åœ°é»ï¼š${latest.location}</span>
                        </p>
                        <div class="mt-2 flex gap-2">
                            <button class="btn btn-xs btn-outline border-terra text-terra hover:bg-terra hover:border-terra hover:text-black" onclick="window.open('${latest.url}', '_blank')">æŸ¥çœ‹è©³æƒ…</button>
                            <button class="btn btn-xs btn-ghost text-gray-400" onclick="hideToast()">é—œé–‰</button>
                        </div>
                    </div>
                </div>`;
            }

            newsData.forEach(item => {
                const li = document.createElement('li');
                let iconClass = 'fa-calendar';
                let colorClass = 'text-gray-400';
                
                if (item.type === 'reptile') { iconClass = 'fa-dragon'; colorClass = 'text-terra'; }
                if (item.type === 'expo') { iconClass = 'fa-store'; colorClass = 'text-aqua'; }
                if (item.type === 'article') { iconClass = 'fa-book-open'; colorClass = 'text-blue-400'; }
                
                li.innerHTML = `
                    <a href="${item.url}" target="_blank" class="flex items-start gap-3 p-2 hover:bg-white/5 rounded-lg transition-colors group/item">
                        <div class="mt-1 ${colorClass}">
                            <i class="fa-solid ${iconClass}"></i>
                        </div>
                        <div>
                            <div class="font-bold text-gray-200 text-sm group-hover/item:text-white transition-colors">${item.title}</div>
                            <div class="text-xs text-gray-500 mt-0.5">
                                <i class="fa-regular fa-clock mr-1"></i>${item.date} 
                                <span class="mx-1">|</span> 
                                ${item.location}
                            </div>
                        </div>
                    </a>
                `;
                list.appendChild(li);
            });
        }

        // æ¨æ’­ Toast æ§åˆ¶
        function showToast() {
            const toast = document.getElementById('toast-container');
            // å»¶é²é¡¯ç¤ºï¼Œæ¨¡æ“¬æ¨æ’­
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 1500);
        }

        function hideToast() {
            const toast = document.getElementById('toast-container');
            toast.classList.add('translate-x-full');
        }

        function toggleNewsToast() {
            const toast = document.getElementById('toast-container');
            if(toast.classList.contains('translate-x-full')) {
                toast.classList.remove('translate-x-full');
            } else {
                toast.classList.add('translate-x-full');
            }
        }


        // å…§å»ºå¸¸è¦‹ç‰©ç¨®è³‡æ–™åº« (ä½œç‚ºé è¨­/å‚™ç”¨è³‡æ–™)
        let speciesData = [
            // ... (åŸæœ¬çš„è³‡æ–™ä¿æŒä¸è®Š)
            {
                id: 'guppy',
                name: 'å­”é›€é­š',
                sci_name: 'Poecilia reticulata',
                type: 'aquarium',
                aliases: ['ç™¾è¬é­š', 'å½©è™¹é­š', 'é³³å°¾é­š', 'guppy'],
                tags: ['æ–°æ‰‹', 'å¥½é¤Š', 'å®¹æ˜“ç¹æ®–', 'å°å‹é­š', 'ç¾¤æ¸¸', 'ä¸Šå±¤é­š', 'beginner', 'easy'],
                persona: ['visual'], 
                image_url: 'https://www.greenflow.hk/cdn/shop/products/Poeciliareticulata_3e788763-6ccb-47b1-b624-7ce90ca715b2.jpg?v=1676023781&width=600',
                temp: '22-28',
                env_label: 'é…¸é¹¼å€¼ (pH)',
                env_val: '7.0 - 8.0',
                difficulty: 1,
                description: 'æ°´æ—ç•Œæœ€ç¶“å…¸çš„å…¥é–€é­šç¨®ï¼Œåˆç¨±ã€Œç™¾è¬é­šã€ï¼Œå› ç‚ºç¹æ®–èƒ½åŠ›æ¥µå¼·ã€‚å­”é›€é­šé©æ‡‰åŠ›æ¥µä½³ï¼Œå–œæ­¡å¼±é¹¼æ€§çš„æ°´è³ªã€‚é›„é­šå°¾é°­è‰²å½©æ–‘æ–•ï¼Œæ˜¯æ¬£è³çš„é‡é»ã€‚é©åˆæ–°æ‰‹å˜—è©¦ç¹æ®–æ¨‚è¶£ã€‚',
                video_id: ['omFaJ266VU0'],
                source: 'ACè‰å½±æ°´æ—',
                img_pos: 'center'
            }
        ];

        // --- é€ æ™¯ç¾å­¸æ•¸æ“šåº« ---
        let landscapingData = [
             {
                id: 'iwagumi',
                title: 'çŸ³çµ„é€ æ™¯ (Iwagumi)',
                tags: ['æ°´æ—', 'æ¥µç°¡', 'é«˜é›£åº¦'],
                image: 'https://images.unsplash.com/photo-1533601017-dc61895e03c0?q=80&w=2070&auto=format&fit=crop',
                desc: 'æºè‡ªæ—¥æœ¬çš„é€ æ™¯é¢¨æ ¼ï¼Œå¼·èª¿ã€Œå¥‡æ•¸ã€å²©çŸ³çš„æ“ºæ”¾å“²å­¸ã€‚',
                elements: ['é’é¾çŸ³', 'è¿·ä½ çŸ®çç ']
            }
        ];

        // --- ç¸é†«è³‡æ–™åº« ---
        let vetData = [
            { name: 'ä¾ç¾…ç´€é‡ç”Ÿå‹•ç‰©å°ˆç§‘é†«é™¢', region: 'north', type: 'reptile', address: 'æ¡ƒåœ’å¸‚æ¡ƒåœ’å€', phone: '03-358-1530', tags: ['çˆ¬èŸ²'] }
        ];

        // --- Google Sheet è¨­å®š ---
        // è«‹å°‡æ‚¨çš„ Google Sheet ç™¼å¸ƒç‚º CSVï¼Œä¸¦å°‡é€£çµè²¼å…¥ä¸‹æ–¹å¼•è™Ÿä¸­
        const GOOGLE_SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVcC7f1pGlK18BIZw303cOGavBhgePJkrS-B4ugeQQjZTI5hnUdulyXmhfzw-H1TJrxK0NGoxaFamB/pub?output=csv"; 

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        window.addEventListener('DOMContentLoaded', async () => {
            await initData(); // ç­‰å¾…è³‡æ–™è¼‰å…¥
            renderNotifications(); // ç¢ºä¿å…ˆè¼‰å…¥è³‡æ–™å†æ¸²æŸ“é€šçŸ¥
            showToast(); 
            filterVets(); 
        });

        // è³‡æ–™åˆå§‹åŒ–å‡½æ•¸
        async function initData() {
            const statusEl = document.getElementById('connection-status');

            if (GOOGLE_SHEET_CSV_URL) {
                try {
                    console.log("æ­£åœ¨å˜—è©¦å¾ Google Sheet è¼‰å…¥è³‡æ–™...");
                    if(statusEl) statusEl.innerHTML = `<span class="loading loading-spinner loading-xs"></span> Connecting to Cloud...`;

                    const response = await fetch(GOOGLE_SHEET_CSV_URL + '&t=' + new Date().getTime());
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const csvText = await response.text();
                    
                    if (csvText.trim().startsWith("<!DOCTYPE html>") || csvText.includes("<html")) {
                        console.error("éŒ¯èª¤ï¼šè®€å–åˆ°çš„ä¸æ˜¯ CSVï¼Œè€Œæ˜¯ HTML ç¶²é ã€‚");
                        if(statusEl) {
                            statusEl.innerHTML = `<div class="w-2 h-2 rounded-full bg-orange-400"></div> Auth Error (Local Data)`;
                            statusEl.classList.add('text-orange-400', 'border-orange-900');
                        }
                        return; 
                    }

                    const result = Papa.parse(csvText, {
                        header: true,
                        skipEmptyLines: true
                    });

                    if (result.data && result.data.length > 0) {
                        const sheetData = [];
                        const sheetLandscaping = [];
                        const sheetVetData = [];
                        const sheetNewsData = []; // æ–°å¢ï¼šæš«å­˜æœ€æ–°æ¶ˆæ¯è³‡æ–™

                        // å»ºç«‹æ¨™é¡Œå°ç…§è¡¨
                        const headerMap = {
                            'id': ['id'],
                            'name': ['name', 'name (åç¨±)'],
                            'sci_name': ['sci_name', 'sci_name (å­¸å)'],
                            'type': ['type', 'type (é¡å‹)'],
                            'aliases': ['aliases', 'alias', 'aliases (åˆ¥å)'],
                            'tags': ['tags', 'tags (æ¨™ç±¤)'],
                            'persona': ['persona', 'persona (å€‹æ€§)'],
                            'image_url': ['image_url', 'image_url (åœ–ç‰‡é€£çµ)', 'img_url'],
                            'temp': ['temp', 'temp (æº«åº¦)'],
                            'env_label': ['env_label', 'env_label (ç’°å¢ƒæ¨™ç±¤)'],
                            'env_val': ['env_val', 'env_val (ç’°å¢ƒæ•¸å€¼)'],
                            'difficulty': ['difficulty', 'difficulty (é›£åº¦)'],
                            'description': ['description', 'description (æè¿°)', 'desc'],
                            'video_id': ['video_id', 'video_id (å½±ç‰‡ID)'],
                            'source': ['source', 'source (ä¾†æº)'],
                            'img_pos': ['img_pos', 'img_pos (åœ–ç‰‡ä½ç½®)']
                        };

                        const getValue = (row, keyName) => {
                            const possibleHeaders = headerMap[keyName] || [keyName];
                            for (const h of possibleHeaders) {
                                if (row[h] !== undefined) return row[h];
                            }
                            return undefined;
                        };

                        const cleanUrl = (url) => {
                            if (!url) return '';
                            return url.replace(/[<>\\"]/g, '').trim();
                        };

                        result.data.forEach(row => {
                            const id = getValue(row, 'id');
                            const name = getValue(row, 'name');
                            const type = getValue(row, 'type');
                            let rawImgUrl = getValue(row, 'image_url');
                            const imageUrl = cleanUrl(rawImgUrl);

                            if (!id || !name) return;

                            const rawAliases = getValue(row, 'aliases');
                            const rawTags = getValue(row, 'tags');
                            const rawPersona = getValue(row, 'persona');
                            const rawEnvVal = getValue(row, 'env_val');
                            const rawVideos = getValue(row, 'video_id');

                            const aliases = rawAliases ? rawAliases.split(/[,ï¼Œ]/).map(s => s.trim()) : [];
                            const tags = rawTags ? rawTags.split(/[,ï¼Œ]/).map(s => s.trim()) : [];
                            const persona = rawPersona ? rawPersona.split(/[,ï¼Œ]/).map(s => s.trim()) : [];
                            
                            if (type === 'landscaping') {
                                sheetLandscaping.push({
                                    id: id,
                                    title: name,
                                    tags: tags,
                                    image: imageUrl,
                                    desc: getValue(row, 'description'),
                                    elements: rawEnvVal ? rawEnvVal.split(/[,ï¼Œ]/).map(s => s.trim()) : []
                                });
                            } else if (type === 'vet') {
                                sheetVetData.push({
                                    name: name,
                                    region: getValue(row, 'img_pos'), 
                                    type: getValue(row, 'sci_name'),  
                                    address: getValue(row, 'description'),
                                    phone: getValue(row, 'env_label'),
                                    tags: tags
                                });
                            } else if (type === 'news') {
                                // æ–°å¢ï¼šè§£æ News é¡å‹
                                // æ¬„ä½å€Ÿç”¨ï¼š
                                // Name -> æ¨™é¡Œ (Title)
                                // Sci_Name -> é¡å‹ (Type: expo, reptile, article)
                                // Env_Label -> æ—¥æœŸ (Date)
                                // Description -> åœ°é» (Location)
                                // Source -> é€£çµ (URL)
                                sheetNewsData.push({
                                    title: name,
                                    type: getValue(row, 'sci_name') || 'expo',
                                    date: getValue(row, 'env_label') || 'Coming Soon',
                                    location: getValue(row, 'description') || '',
                                    url: getValue(row, 'source') || '#'
                                });
                            } else {
                                let videos = [];
                                if (rawVideos) {
                                    if (rawVideos.includes(',') || rawVideos.includes('ï¼Œ')) {
                                        videos = rawVideos.split(/[,ï¼Œ]/).map(v => v.trim());
                                    } else {
                                        videos = [rawVideos.trim()];
                                    }
                                }

                                sheetData.push({
                                    id: id,
                                    name: name,
                                    sci_name: getValue(row, 'sci_name'),
                                    type: type,
                                    aliases: aliases,
                                    tags: tags,
                                    persona: persona,
                                    image_url: imageUrl,
                                    temp: getValue(row, 'temp'),
                                    env_label: getValue(row, 'env_label'),
                                    env_val: rawEnvVal,
                                    difficulty: parseInt(getValue(row, 'difficulty')) || 1,
                                    description: getValue(row, 'description'),
                                    video_id: videos,
                                    source: getValue(row, 'source'),
                                    img_pos: getValue(row, 'img_pos') || 'center'
                                });
                            }
                        });

                        if (sheetData.length > 0) speciesData = sheetData;
                        if (sheetLandscaping.length > 0) landscapingData = sheetLandscaping;
                        if (sheetVetData.length > 0) vetData = sheetVetData;
                        
                        // æ–°å¢ï¼šè¦†è“‹æœ€æ–°æ¶ˆæ¯
                        if (sheetNewsData.length > 0) {
                            newsData = sheetNewsData;
                            console.log("æœ€æ–°æ¶ˆæ¯è³‡æ–™è¼‰å…¥æˆåŠŸ:", newsData);
                        }
                        
                        console.log("æˆåŠŸè¼‰å…¥æ‰€æœ‰ Google Sheet è³‡æ–™!");
                        
                        if(statusEl) {
                            statusEl.innerHTML = `<div class="w-2 h-2 rounded-full bg-green-400"></div> Google Sheet Sync (Live)`;
                            statusEl.classList.remove('border-gray-700', 'text-gray-500');
                            statusEl.classList.add('border-green-900', 'text-green-400', 'bg-green-900/20');
                        }
                    }
                } catch (error) {
                    console.error("è¼‰å…¥ Google Sheet å¤±æ•—:", error);
                    if(statusEl) {
                        statusEl.innerHTML = `<div class="w-2 h-2 rounded-full bg-orange-400"></div> Local Data (Offline Mode)`;
                        statusEl.classList.add('text-orange-400', 'border-orange-900');
                    }
                }
            }
        }

        // æœå°‹é‚è¼¯
        let currentSearchFilter = 'all';
        
        function setSearchFilter(filter) {
            currentSearchFilter = filter;
            const filterLabel = {
                'all': 'å…¨éƒ¨',
                'aquarium': 'æ°´æ—',
                'amphibian': 'å…©æ£²'
            };
            
            // æ›´æ–° UI æç¤º
            const tag = document.getElementById('filter-tag');
            tag.innerText = `æœå°‹ç¯„åœ: ${filterLabel[filter]}`;
            tag.classList.remove('opacity-0');
            
            // é‡æ–°è§¸ç™¼æœå°‹
            const input = document.getElementById('search-input');
            if(input.value.trim() !== '') {
                performSearch(input.value);
            }
        }

        // å€‹æ€§åŒ–æ¨è–¦é‚è¼¯
        function performRecommendation(persona) {
            document.getElementById('recommendation_modal').close();
            
            document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'});
            
            const catView = document.getElementById('category-view');
            const speciesView = document.getElementById('species-view');
            const landscapingView = document.getElementById('landscaping-view');
            const currentLabel = document.getElementById('current-category-label');

            catView.classList.add('hidden', 'opacity-0');
            landscapingView.classList.add('hidden', 'opacity-0'); 
            speciesView.classList.remove('hidden');
            setTimeout(() => {
                speciesView.classList.remove('opacity-0', 'translate-y-10');
            }, 50);

            const filteredData = speciesData.filter(s => s.persona && s.persona.includes(persona));
            
            const personaLabels = {
                'lazy': 'æ‡¶äºº / å¿™ç¢Œä¸€æ—',
                'interactive': 'å–œæ­¡äº’å‹•é™ªä¼´',
                'office': 'è¾¦å…¬å®¤ç™‚ç™’å°ç‰©',
                'cool': 'å¸¥æ°£ / ç‰¹åˆ¥ç‰©ç¨®'
            };
            
            currentLabel.innerText = `âœ¨ ç‚ºæ‚¨æ¨è–¦ï¼š${personaLabels[persona]} (${filteredData.length} ç¨®)`;
            
            renderButtons(filteredData);
            
            if(filteredData.length > 0) {
                renderSpecies(filteredData[0].id);
            }
        }

        function performSearch(query) {
            const resultsContainer = document.getElementById('search-results');
            const normalizedQuery = query.toLowerCase().trim();
            
            if (normalizedQuery === '') {
                resultsContainer.classList.add('hidden');
                return;
            }

            const results = speciesData.filter(species => {
                if (currentSearchFilter !== 'all' && species.type !== currentSearchFilter) {
                    return false;
                }

                const nameMatch = species.name.includes(normalizedQuery);
                const sciNameMatch = species.sci_name.toLowerCase().includes(normalizedQuery);
                const aliasMatch = species.aliases.some(alias => alias.toLowerCase().includes(normalizedQuery));
                const tagMatch = species.tags.some(tag => tag.toLowerCase().includes(normalizedQuery));

                return nameMatch || sciNameMatch || aliasMatch || tagMatch;
            });

            resultsContainer.innerHTML = '';
            if (results.length > 0) {
                results.forEach(species => {
                    const div = document.createElement('div');
                    div.className = 'p-3 hover:bg-white/10 cursor-pointer border-b border-gray-800 last:border-none flex items-center gap-3 transition-colors';
                    div.onclick = () => {
                        jumpToSpecies(species.type, species.id);
                        resultsContainer.classList.add('hidden'); 
                        document.getElementById('search-input').value = ''; 
                    };

                    const typeColor = species.type === 'aquarium' ? 'text-aqua' : 'text-terra';
                    const typeLabel = species.type === 'aquarium' ? 'æ°´æ—' : 'å…©æ£²';

                    div.innerHTML = `
                        <div class="w-10 h-10 rounded-lg overflow-hidden flex-shrink-0">
                            <img src="${species.image_url}" referrerpolicy="no-referrer" class="w-full h-full object-cover">
                        </div>
                        <div>
                            <div class="font-bold text-gray-200">${species.name}</div>
                            <div class="text-xs text-gray-500">
                                <span class="${typeColor} mr-2">â— ${typeLabel}</span>
                                ${species.aliases.join(', ')}
                            </div>
                        </div>
                    `;
                    resultsContainer.appendChild(div);
                });
                resultsContainer.classList.remove('hidden');
            } else {
                resultsContainer.innerHTML = '<div class="p-4 text-center text-gray-500 text-sm">æ‰¾ä¸åˆ°ç›¸é—œç‰©ç¨®</div>';
                resultsContainer.classList.remove('hidden');
            }
        }

        function jumpToSpecies(category, id) {
            document.getElementById('main-interface').scrollIntoView({behavior: 'smooth'});
            
            selectCategory(category);

            setTimeout(() => {
                renderSpecies(id);
                
                const buttons = document.querySelectorAll('#species-buttons-container button');
                buttons.forEach(btn => {
                    if (btn.dataset.id === id) {
                        updateActiveButton(btn, category === 'amphibian');
                    }
                });
            }, 400); 
        }

        document.getElementById('search-input').addEventListener('input', (e) => {
            performSearch(e.target.value);
        });

        document.addEventListener('click', (e) => {
            const searchContainer = document.querySelector('.relative.max-w-2xl');
            if (!searchContainer.contains(e.target)) {
                document.getElementById('search-results').classList.add('hidden');
            }
        });

        function resetToCategories() {
            const catView = document.getElementById('category-view');
            const speciesView = document.getElementById('species-view');
            const landscapingView = document.getElementById('landscaping-view');
            
            speciesView.classList.add('hidden', 'opacity-0', 'translate-y-10');
            landscapingView.classList.add('hidden', 'opacity-0', 'translate-y-10');
            
            catView.classList.remove('hidden');
            setTimeout(() => {
                catView.classList.remove('opacity-0', 'translate-y-10');
            }, 50);
        }

        function selectCategory(categoryType) {
            const catView = document.getElementById('category-view');
            const speciesView = document.getElementById('species-view');
            const landscapingView = document.getElementById('landscaping-view');
            const currentLabel = document.getElementById('current-category-label');

            catView.classList.add('opacity-0', 'translate-y-10');
            landscapingView.classList.add('hidden', 'opacity-0'); 
            
            setTimeout(() => {
                catView.classList.add('hidden');
                
                const filteredData = speciesData.filter(s => s.type === categoryType);
                
                renderButtons(filteredData);
                
                if(filteredData.length > 0) {
                    renderSpecies(filteredData[0].id);
                }

                currentLabel.innerText = categoryType === 'aquarium' ? 'ç›®å‰ç€è¦½ï¼šæ°´æ—ä¸–ç•Œ' : 'ç›®å‰ç€è¦½ï¼šå…©æ£²çˆ¬èŸ²';

                speciesView.classList.remove('hidden');
                setTimeout(() => {
                    speciesView.classList.remove('opacity-0', 'translate-y-10');
                }, 50);

            }, 300); 
        }

        // --- é€ æ™¯é é¢é‚è¼¯ ---
        function showLandscapingView() {
            document.getElementById('category-view').classList.add('hidden', 'opacity-0');
            document.getElementById('species-view').classList.add('hidden', 'opacity-0');
            
            const view = document.getElementById('landscaping-view');
            view.classList.remove('hidden');
            setTimeout(() => {
                view.classList.remove('opacity-0', 'translate-y-10');
            }, 50);

            const grid = document.getElementById('landscaping-grid');
            
            grid.innerHTML = ''; 
            
            landscapingData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'group relative h-72 rounded-2xl overflow-hidden cursor-pointer border border-gray-800 hover:border-aqua transition-all duration-500 hover:-translate-y-2 hover:shadow-2xl';
                card.onclick = () => openStyleModal(item);
                
                const fallbackImage = 'https://images.unsplash.com/photo-1533601017-dc61895e03c0?q=80&w=2070&auto=format&fit=crop';
                
                card.innerHTML = `
                    <img src="${item.image}" 
                            referrerpolicy="no-referrer"
                            class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 group-hover:filter group-hover:brightness-75" 
                            alt="${item.title}"
                            onerror="this.src='${fallbackImage}'">
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent opacity-90"></div>
                    <div class="absolute bottom-0 left-0 p-6 w-full translate-y-2 group-hover:translate-y-0 transition-transform duration-500">
                        <div class="flex gap-2 mb-2 opacity-0 group-hover:opacity-100 transition-opacity duration-500 delay-100">
                            ${item.tags.map(t => `<span class="badge badge-xs bg-aqua/20 border-none text-aqua font-bold px-2 py-2">${t}</span>`).join('')}
                        </div>
                        <h3 class="text-2xl font-serif font-bold text-white group-hover:text-aqua transition-colors">${item.title}</h3>
                        <div class="h-1 w-0 group-hover:w-full bg-aqua mt-3 transition-all duration-500"></div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function openStyleModal(item) {
            const modalImg = document.getElementById('style-modal-img');
            modalImg.src = item.image;
            modalImg.setAttribute('referrerpolicy', 'no-referrer');
            
            document.getElementById('style-modal-title').innerText = item.title;
            document.getElementById('style-modal-desc').innerText = item.desc;
            
            const tagsContainer = document.getElementById('style-modal-tags');
            tagsContainer.innerHTML = item.tags.map(t => `<span class="badge badge-outline text-gray-400">${t}</span>`).join('');
            
            const elementsContainer = document.getElementById('style-modal-elements');
            elementsContainer.innerHTML = item.elements.map(e => `<li class="flex items-center"><i class="fa-solid fa-check text-aqua mr-2 text-xs"></i>${e}</li>`).join('');
            
            document.getElementById('style_modal').showModal();
        }

        // --- ç¸é†«åœ°åœ–é‚è¼¯ ---
        function filterVets() {
            const region = document.getElementById('vet-region').value;
            const type = document.getElementById('vet-type').value;
            
            const list = document.getElementById('vet-list');
            list.innerHTML = '';
            
            const filtered = vetData.filter(v => {
                const regionMatch = region === 'all' || v.region === region;
                const typeMatch = type === 'all' || v.type === type || (type === 'reptile' && v.type === 'reptile') || (type === 'aquatic' && v.type === 'aquatic'); 
                return regionMatch && typeMatch;
            });

            if (filtered.length === 0) {
                list.innerHTML = `<div class="col-span-full text-center py-8 text-gray-500">æ­¤ç¯©é¸æ¢ä»¶ä¸‹ç„¡è³‡æ–™</div>`;
                return;
            }

            filtered.forEach(vet => {
                const div = document.createElement('div');
                div.className = 'bg-white/5 p-4 rounded-xl border border-gray-700 hover:border-gray-500 transition-colors flex justify-between items-center group';
                
                let icon = vet.type === 'aquatic' ? 'fa-fish text-blue-400' : 'fa-dragon text-terra';
                let phoneHtml = vet.phone ? `<div class="text-xs text-gray-400 mt-0.5"><i class="fa-solid fa-phone mr-1.5 text-gray-600"></i>${vet.phone}</div>` : '';

                div.innerHTML = `
                    <div>
                        <div class="font-bold text-gray-200 flex items-center gap-2 text-sm md:text-base">
                            <i class="fa-solid ${icon}"></i> ${vet.name}
                        </div>
                        <div class="text-xs text-gray-500 mt-1"><i class="fa-solid fa-location-dot mr-1.5 text-gray-600"></i>${vet.address}</div>
                        ${phoneHtml}
                        <div class="flex flex-wrap gap-1 mt-2">
                            ${vet.tags.map(t => `<span class="text-[10px] px-1.5 py-0.5 bg-gray-800 border border-gray-700 rounded text-gray-400">${t}</span>`).join('')}
                        </div>
                    </div>
                    <button class="btn btn-sm btn-circle btn-ghost text-gray-500 hover:text-white hover:bg-white/10" onclick="window.open('https://www.google.com/maps/search/?api=1&query=${vet.name}', '_blank')">
                        <i class="fa-solid fa-diamond-turn-right text-lg"></i>
                    </button>
                `;
                list.appendChild(div);
            });
        }

        // æ¸²æŸ“æŒ‰éˆ•åˆ—è¡¨ (æ¥æ”¶éæ¿¾å¾Œçš„è³‡æ–™)
        function renderButtons(filteredData) {
            const container = document.getElementById('species-buttons-container');
            container.innerHTML = '';

            filteredData.forEach((item, index) => {
                const btn = document.createElement('button');
                const isAmphibian = item.type === 'amphibian';
                
                const hoverClass = isAmphibian ? 'hover:text-terra' : 'hover:text-aqua';
                
                btn.className = `species-btn snap-start shrink-0 px-5 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all font-medium text-gray-400 ${hoverClass}`;
                btn.dataset.id = item.id;
                
                btn.innerHTML = `<span class="mr-2 text-xs opacity-50">${isAmphibian ? 'â—' : 'â—'}</span>${item.name}`;
                btn.onclick = function() { 
                    renderSpecies(item.id); 
                    updateActiveButton(this, isAmphibian);
                };
                
                container.appendChild(btn);
            });

            const firstBtn = container.querySelector('button');
            if(firstBtn) {
                const firstItem = filteredData[0];
                updateActiveButton(firstBtn, firstItem.type === 'amphibian');
            }
        }

        function updateActiveButton(activeBtn, isAmphibian) {
            document.querySelectorAll('.species-btn').forEach(btn => {
                btn.className = `species-btn snap-start shrink-0 px-5 py-3 rounded-xl bg-white/5 hover:bg-white/10 transition-all font-medium text-gray-400 ${isAmphibian ? 'hover:text-terra' : 'hover:text-aqua'}`;
            });
            
            const activeClass = isAmphibian ? 'text-terra bg-terra/10 ring-1 ring-terra/50' : 'text-aqua bg-aqua/10 ring-1 ring-aqua/50';
            activeBtn.className = `species-btn snap-start shrink-0 px-5 py-3 rounded-xl transition-all font-bold shadow-lg ${activeClass}`;
            
            activeBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        }

        // æ¸²æŸ“ç‰©ç¨®è©³ç´°è³‡æ–™
        function renderSpecies(id) {
            const data = speciesData.find(s => s.id === id);
            if(!data) return;

            const content = document.getElementById('species-content');
            
            content.style.opacity = '0.5';
            
            setTimeout(() => {
                const isAmphibian = data.type === 'amphibian';
                const themeColor = isAmphibian ? 'text-terra' : 'text-aqua';
                
                const imgElement = document.getElementById('species-image');
                imgElement.src = data.image_url;
                imgElement.style.objectPosition = data.img_pos || 'center';
                
                document.getElementById('species-name').innerText = data.name;
                document.getElementById('species-name').className = `text-4xl md:text-5xl font-serif font-bold tracking-wide mb-1 ${themeColor}`;
                document.getElementById('species-sci-name').innerText = data.sci_name;
                document.getElementById('species-desc').innerText = data.description;
                document.getElementById('species-desc').className = `text-gray-400 mb-2 leading-relaxed text-lg border-l-4 pl-6 ${isAmphibian ? 'border-terra' : 'border-aqua'}`;

                const typeBadge = document.getElementById('species-type-badge');
                typeBadge.innerText = isAmphibian ? 'å…©æ£²é¡ (Amphibian)' : 'æ°´æ—é¡ (Aquarium)';
                typeBadge.className = `badge badge-outline mb-2 ${isAmphibian ? 'border-terra text-terra' : 'border-aqua text-aqua'}`;
                
                document.getElementById('data-source').innerText = data.source;
                document.getElementById('data-source-mobile').innerText = data.source;
                document.getElementById('video-source-label').innerText = data.source;

                document.getElementById('stat-temp').innerText = data.temp + 'Â°C';
                document.getElementById('stat-env-label').innerText = data.env_label;
                document.getElementById('stat-env-val').innerText = data.env_val;
                document.getElementById('stat-env-val').className = `text-xl font-bold pl-1 ${themeColor}`;

                const starsContainer = document.getElementById('difficulty-stars');
                starsContainer.innerHTML = '';
                for(let i=0; i<5; i++) {
                    if(i < data.difficulty) {
                        starsContainer.innerHTML += '<i class="fa-solid fa-star"></i>';
                    } else {
                        starsContainer.innerHTML += '<i class="fa-regular fa-star text-gray-600"></i>';
                    }
                }

                const videoFrame = document.getElementById('species-video');
                const switcherContainer = document.getElementById('video-switcher');
                const fallbackLink = document.getElementById('video-fallback-link');
                
                switcherContainer.innerHTML = '';
                switcherContainer.classList.add('hidden');

                if (Array.isArray(data.video_id)) {
                    updateVideoPlayer(data.video_id[0]);
                    
                    switcherContainer.classList.remove('hidden');
                    
                    data.video_id.forEach((vid, index) => {
                        const btn = document.createElement('button');
                        btn.className = `btn btn-xs ${index === 0 ? 'btn-primary' : 'btn-outline border-gray-600 text-gray-400 hover:text-white'} rounded-full px-4 transition-all`;
                        btn.innerText = `ç¬¬ ${index + 1} é›†`;
                        
                        btn.onclick = () => {
                            updateVideoPlayer(vid);
                            Array.from(switcherContainer.children).forEach(b => {
                                b.className = 'btn btn-xs btn-outline border-gray-600 text-gray-400 hover:text-white rounded-full px-4 transition-all';
                            });
                            btn.className = 'btn btn-xs btn-primary rounded-full px-4 transition-all';
                        };
                        
                        switcherContainer.appendChild(btn);
                    });

                } else {
                    updateVideoPlayer(data.video_id);
                }

                function updateVideoPlayer(vid) {
                    videoFrame.src = `https://www.youtube-nocookie.com/embed/${vid}?rel=0&playsinline=1`;
                    fallbackLink.href = `https://www.youtube.com/watch?v=${vid}`;
                }

                content.style.opacity = '1';
            }, 200);
        }

        // --- æ–°å¢ï¼šé€šçŸ¥ä¸­å¿ƒçš„ JS æ§åˆ¶é‚è¼¯ ---

        function toggleNotification(e) {
            e.stopPropagation(); // é˜»æ­¢å†’æ³¡ï¼Œé¿å…è§¸ç™¼å…¨åŸŸé»æ“Šäº‹ä»¶
            const dropdown = document.getElementById('notification-dropdown');
            
            if (dropdown.classList.contains('dropdown-open')) {
                // å¦‚æœå·²ç¶“æ‰“é–‹ï¼Œå‰‡é—œé–‰
                dropdown.classList.remove('dropdown-open');
                // ç§»é™¤ç„¦é»ï¼Œé¿å… CSS å¹²æ“¾
                if (document.activeElement) document.activeElement.blur();
            } else {
                // å¦‚æœé—œé–‰ï¼Œå‰‡æ‰“é–‹
                dropdown.classList.add('dropdown-open');
            }
        }

        function closeNotification(e) {
            // å¦‚æœæœ‰é»æ“Šäº‹ä»¶å‚³å…¥ï¼Œé˜»æ­¢å®ƒå†’æ³¡
            if(e) e.stopPropagation();
            
            const dropdown = document.getElementById('notification-dropdown');
            if (dropdown) {
                dropdown.classList.remove('dropdown-open');
            }
        }

        // å…¨åŸŸé»æ“Šç›£è½ï¼šé»æ“Šç©ºç™½è™•é—œé–‰
        document.addEventListener('click', function(e) {
            const dropdown = document.getElementById('notification-dropdown');
            // å¦‚æœé»æ“Šç›®æ¨™ä¸åœ¨ dropdown å…§éƒ¨
            if (dropdown && !dropdown.contains(e.target)) {
                dropdown.classList.remove('dropdown-open');
            }
        });
    </script>

</body>
</html>
